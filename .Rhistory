autopista_MENSUAL$Mes_numeric <- as.yearmon(parse_date(autopista_MENSUAL$Mes_numeric,
"%b %Y",locale=locale("es")))
autopista_MENSUAL$yearmon <- NULL
autopista_MENSUAL <- autopista_MENSUAL %>% arrange(Mes_numeric)
return(autopista_MENSUAL[, c(8, 2)])
View(autopista)
View(autopista)
autopista_MENSUAL <- autopista[complete.cases(autopista$Mes)]
autopista <- fread("dat/06020701_madrid_guadalajara.csv")
autopista <- fread("dat/06020701_madrid_guadalajara.csv")
autopista$V7 <- autopista$V8 <- NULL
autopista <- autopista[complete.cases(autopista$V3)]
autopista <- as.data.frame(autopista)
autopista <-  transform(autopista, V1 = colsplit(V1, split = " ", names = c('Year', 'Mes')))
autopista$Year <- autopista$V1$Year
autopista$Mes <- autopista$V1$Mes
autopista$V1 <- NULL
colnames(autopista) <- c("Longitud", "IMD_total", "variacion_IMD_tot.porcentaje", "IMD_pesados", "variacion_IMD_pes.porcentaje", "Year", "Mes")
autopista$Longitud <- as.numeric(gsub(",", "\\.", autopista$Longitud))
autopista$IMD_total <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_total)))
autopista$variacion_IMD_tot.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_tot.porcentaje))
autopista$IMD_pesados <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_pesados)))
autopista$variacion_IMD_pes.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_pes.porcentaje))
autopista$Year <- gsub('[a-z]', NA, autopista$Year)
autopista <- autopista %>% mutate(Year = na.locf(Year, na.rm = FALSE,fromLast=FALSE))
autopista$Mes <- gsub('[0-9]', NA, autopista$Mes)
autopista_MENSUAL <- autopista[complete.cases(autopista$Mes)]
autopista_ANUAL <- autopista_ANUAL %>%
mutate(variacion_IMD_pes.porcentaje = ifelse(is.na(variacion_IMD_pes.porcentaje),
100*(IMD_pesados-lead(IMD_pesados))/IMD_pesados, variacion_IMD_pes.porcentaje))
rm(list=ls())
suppressMessages({
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
})
autopista <- fread("dat/06020701_madrid_guadalajara.csv")
autopista$V7 <- autopista$V8 <- NULL
autopista <- autopista[complete.cases(autopista$V3)]
autopista <- as.data.frame(autopista)
autopista <- as.data.frame(autopista)
autopista <-  transform(autopista, V1 = colsplit(V1, split = " ", names = c('Year', 'Mes')))
autopista$Year <- autopista$V1$Year
autopista$Mes <- autopista$V1$Mes
autopista$V1 <- NULL
colnames(autopista) <- c("Longitud", "IMD_total", "variacion_IMD_tot.porcentaje", "IMD_pesados", "variacion_IMD_pes.porcentaje", "Year", "Mes")
autopista$Longitud <- as.numeric(gsub(",", "\\.", autopista$Longitud))
autopista$IMD_total <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_total)))
autopista$variacion_IMD_tot.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_tot.porcentaje))
autopista$IMD_pesados <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_pesados)))
autopista$variacion_IMD_pes.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_pes.porcentaje))
autopista$Year <- gsub('[a-z]', NA, autopista$Year)
autopista <- autopista %>% mutate(Year = na.locf(Year, na.rm = FALSE,fromLast=FALSE))
autopista$Mes <- gsub('[0-9]', NA, autopista$Mes)
autopista_MENSUAL <- autopista[complete.cases(autopista$Mes)]
View(autopista)
autopista <- fread("dat/06020701_madrid_guadalajara.csv")
autopista$V7 <- autopista$V8 <- NULL
#borro filas al principio y final de la 1 a 6 y de la 362 a 368. Además la 34 que separa datos anuales de mensuales:
# autopista <- autopista[!c(1:6, 34, 362:368) , ]
autopista <- autopista[complete.cases(autopista$V3),]
#separo la primera columna en Mes/Año y relleno las de año incompleto
autopista <- as.data.frame(autopista)
autopista <-  transform(autopista, V1 = colsplit(V1, split = " ", names = c('Year', 'Mes')))
#renombro columnas
autopista$Year <- autopista$V1$Year
autopista$Mes <- autopista$V1$Mes
autopista$V1 <- NULL
colnames(autopista) <- c("Longitud", "IMD_total", "variacion_IMD_tot.porcentaje", "IMD_pesados", "variacion_IMD_pes.porcentaje", "Year", "Mes")
#voy a poner los tipos de las columnas ok:
#tipo numérico
autopista$Longitud <- as.numeric(gsub(",", "\\.", autopista$Longitud))
autopista$IMD_total <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_total)))
autopista$variacion_IMD_tot.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_tot.porcentaje))
autopista$IMD_pesados <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_pesados)))
autopista$variacion_IMD_pes.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_pes.porcentaje))
#tipo character y relleno huecos:
autopista$Year <- gsub('[a-z]', NA, autopista$Year)
autopista <- autopista %>% mutate(Year = na.locf(Year, na.rm = FALSE,fromLast=FALSE))
autopista$Mes <- gsub('[0-9]', NA, autopista$Mes)
# autopista_ANUAL <- autopista[1:27, 1:6]
# autopista_MENSUAL <- autopista[28:354, ]
autopista_MENSUAL <- autopista[complete.cases(autopista$Mes),]
# Porque los 0s los pilla co
View(autopista)
View(autopista_MENSUAL)
View(autopista)
View(autopista_MENSUAL)
autopista_ANUAL <- autopista_ANUAL %>%
mutate(variacion_IMD_pes.porcentaje = ifelse(is.na(variacion_IMD_pes.porcentaje),
100*(IMD_pesados-lead(IMD_pesados))/IMD_pesados, variacion_IMD_pes.porcentaje))
autopista_MENSUAL$yearmon <- paste(autopista_MENSUAL$Mes, " ", autopista_MENSUAL$Year)
autopista_MENSUAL$yearmon <- as.yearmon(paste(autopista_MENSUAL$Mes, " ",
autopista_MENSUAL$Year), "%b %Y")
# autopista_MENSUAL$Mes <- years(autopista_MENSUAL$Mes)
autopista_MENSUAL$Mes_numeric <- autopista_MENSUAL$Mes
autopista_MENSUAL$Mes_numeric <- paste(tolower(autopista_MENSUAL$Mes_numeric),".")
autopista_MENSUAL$Mes_numeric <- gsub('sep', "sept", autopista_MENSUAL$Mes_numeric)
autopista_MENSUAL$Mes_numeric <- gsub(' ', "", autopista_MENSUAL$Mes_numeric)
autopista_MENSUAL$Mes_numeric <- paste(autopista_MENSUAL$Mes_numeric," ", autopista_MENSUAL$Year)
autopista_MENSUAL$Mes_numeric <- as.yearmon(parse_date(autopista_MENSUAL$Mes_numeric,
"%b %Y",locale=locale("es")))
autopista_MENSUAL$yearmon <- NULL
autopista_MENSUAL <- autopista_MENSUAL %>% arrange(Mes_numeric)
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
library(ggplot2)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
library(ggplot2)
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
library(ggplot2)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
library(ggplot2)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
autopista <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
# autopista <- lee_autopista(fread("../dat/06020101_montmelo_la_junquera.csv"))
# autopista <- lee_autopista(fread("../dat/06020102_barcelona_tarragona_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020103_montmelo_papiol_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020201_zaragoza_mediterraneo_A_2.csv"))
# autopista <- lee_autopista(fread("../dat/06020202_villalba_adanero_A_6.csv"))
# autopista <- lee_autopista(fread("../dat/06020301_tarragona_valencia_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020302_valencia_alicante_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020303_ferrol_fr_portuguesa_A_9.csv"))
# autopista <- lee_autopista(fread("../dat/06020401_bilbao_zaragoza_A_68.csv"))
# autopista <- lee_autopista(fread("../dat/06020402_burgos_armiñon_A_1.csv"))
# autopista <- lee_autopista(fread("../dat/06020403_leon_campomanes_A_66.csv"))
# autopista <- lee_autopista(fread("../dat/06020501_malaga_guadiaro.csv"))
# autopista <- lee_autopista(fread("../dat/06020502_alicante_cartagena.csv"))
# autopista <- lee_autopista(fread("../dat/06020503_avila_villacastin.csv"))
# autopista <- lee_autopista(fread("../dat/06020601_leon_astorga.csv"))
# autopista <- lee_autopista(fread("../dat/06020602_santiago_alto_sto_domingo.csv"))
# autopista <- lee_autopista(fread("../dat/06020603_segovia_san_rafael.csv"))
# autopista <- lee_autopista(fread("../dat/06020701_madrid_guadalajara.csv"))
# autopista <- lee_autopista(fread("../dat/06020702_madrid_arganda.csv"))
# autopista <- lee_autopista(fread("../dat/06020703_madrid_navalcarnero.csv"))
# autopista <- lee_autopista(fread("../dat/06020801_madrid_ocaña.csv"))
# autopista <- lee_autopista(fread("../dat/06020802_eje_aeropuerto.csv"))
# autopista <- lee_autopista(fread("../dat/06020803_ocaña_la_roda.csv"))
# autopista <- lee_autopista(fread("../dat/06020901_madrid_toledo.csv"))
# autopista <- lee_autopista(fread("../dat/06020902_cartagena_vera.csv"))
# autopista <- lee_autopista(fread("../dat/06020903_circunvalacion_alicante.csv"))
# autopista <- lee_autopista(fread("../dat/06021001_alto_de_las_pedrizas_malaga.csv"))
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
library(ggplot2)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
# autopista <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
# autopista <- lee_autopista(fread("../dat/06020101_montmelo_la_junquera.csv"))
# autopista <- lee_autopista(fread("../dat/06020102_barcelona_tarragona_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020103_montmelo_papiol_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020201_zaragoza_mediterraneo_A_2.csv"))
# autopista <- lee_autopista(fread("../dat/06020202_villalba_adanero_A_6.csv"))
# autopista <- lee_autopista(fread("../dat/06020301_tarragona_valencia_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020302_valencia_alicante_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020303_ferrol_fr_portuguesa_A_9.csv"))
# autopista <- lee_autopista(fread("../dat/06020401_bilbao_zaragoza_A_68.csv"))
# autopista <- lee_autopista(fread("../dat/06020402_burgos_armiñon_A_1.csv"))
# autopista <- lee_autopista(fread("../dat/06020403_leon_campomanes_A_66.csv"))
# autopista <- lee_autopista(fread("../dat/06020501_malaga_guadiaro.csv"))
# autopista <- lee_autopista(fread("../dat/06020502_alicante_cartagena.csv"))
# autopista <- lee_autopista(fread("../dat/06020503_avila_villacastin.csv"))
# autopista <- lee_autopista(fread("../dat/06020601_leon_astorga.csv"))
# autopista <- lee_autopista(fread("../dat/06020602_santiago_alto_sto_domingo.csv"))
# autopista <- lee_autopista(fread("../dat/06020603_segovia_san_rafael.csv"))
autopista <- lee_autopista(fread("../dat/06020701_madrid_guadalajara.csv"))
# autopista <- lee_autopista(fread("../dat/06020702_madrid_arganda.csv"))
# autopista <- lee_autopista(fread("../dat/06020703_madrid_navalcarnero.csv"))
# autopista <- lee_autopista(fread("../dat/06020801_madrid_ocaña.csv"))
# autopista <- lee_autopista(fread("../dat/06020802_eje_aeropuerto.csv"))
# autopista <- lee_autopista(fread("../dat/06020803_ocaña_la_roda.csv"))
# autopista <- lee_autopista(fread("../dat/06020901_madrid_toledo.csv"))
# autopista <- lee_autopista(fread("../dat/06020902_cartagena_vera.csv"))
# autopista <- lee_autopista(fread("../dat/06020903_circunvalacion_alicante.csv"))
# autopista <- lee_autopista(fread("../dat/06021001_alto_de_las_pedrizas_malaga.csv"))
q1 <- autopista
# ts_mensual <- as_xts(q1, date_col = Mes_numeric)
ts_mensual <- ts(autopista$IMD_total, start=c(1990, 1), end=c(2017, 3), frequency=12)
plot(ts_mensual)
summary(ts_mensual)
fit <- stl(ts_mensual, s.window="period")
plot(fit)
monthplot(ts_mensual, col=1:12, pch=19)
seasonplot(ts_mensual, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
train <- window(ts_mensual, start=c(1990, 01), end=c(2014, 12))
plot(train)
test <- window(ts_mensual, start=c(2015, 01), end=c(2016, 12))
plot(test)
fit <- ets(train)
fit
prediccion <- forecast(fit)
par(mfrow=c(1,1))
plot(prediccion)
lines(test, col="red")
accuracy(prediccion,test)
fit2 <- auto.arima(train)
fit2
prediccion2 <- forecast(fit2)
prediccion2
plot(prediccion2)
lines(test, col="red")
accuracy(prediccion2,test)
accuracy(prediccion,test)
hist(residuals(fit2))
tsdisplay(residuals(fit2))
Box.test(residuals(fit2), type="Ljung")
l.ts_mensual <- log(ts_mensual)
par(mfrow=c(2,1))
plot(ts_mensual)
plot(l.ts_mensual)
summary(l.ts_mensual)
fit <- stl(l.ts_mensual, s.window="period")
plot(fit)
monthplot(l.ts_mensual, col=1:12, pch=19)
seasonplot(l.ts_mensual, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
train <- window(l.ts_mensual, start=c(1990, 01), end=c(2014, 12))
plot(train)
test <- window(l.ts_mensual, start=c(2015, 01), end=c(2016, 12))
plot(test)
fit <- ets(train)
fit
prediccion <- forecast(fit)
par(mfrow=c(1,1))
plot(prediccion)
lines(test, col="red")
accuracy(prediccion,test)
fit2 <- auto.arima(train)
fit2
prediccion2 <- forecast(fit2)
prediccion2
plot(prediccion2)
lines(test, col="red")
accuracy(prediccion2,test)
accuracy(prediccion,test)
tsdisplay(residuals(fit2))
hist(residuals(fit2))
Box.test(residuals(fit2),  type="Ljung")
View(autopista)
View(autopista)
q1 <- autopista
# ts_mensual <- as_xts(q1, date_col = Mes_numeric)
ts_mensual <- ts(autopista$IMD_total, start=c(2003, 03), end=c(2017, 3), frequency=12)
plot(ts_mensual)
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
library(ggplot2)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
# autopista <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
# autopista <- lee_autopista(fread("../dat/06020101_montmelo_la_junquera.csv"))
# autopista <- lee_autopista(fread("../dat/06020102_barcelona_tarragona_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020103_montmelo_papiol_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020201_zaragoza_mediterraneo_A_2.csv"))
# autopista <- lee_autopista(fread("../dat/06020202_villalba_adanero_A_6.csv"))
# autopista <- lee_autopista(fread("../dat/06020301_tarragona_valencia_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020302_valencia_alicante_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020303_ferrol_fr_portuguesa_A_9.csv"))
# autopista <- lee_autopista(fread("../dat/06020401_bilbao_zaragoza_A_68.csv"))
# autopista <- lee_autopista(fread("../dat/06020402_burgos_armiñon_A_1.csv"))
# autopista <- lee_autopista(fread("../dat/06020403_leon_campomanes_A_66.csv"))
# autopista <- lee_autopista(fread("../dat/06020501_malaga_guadiaro.csv"))
# autopista <- lee_autopista(fread("../dat/06020502_alicante_cartagena.csv"))
# autopista <- lee_autopista(fread("../dat/06020503_avila_villacastin.csv"))
# autopista <- lee_autopista(fread("../dat/06020601_leon_astorga.csv"))
# autopista <- lee_autopista(fread("../dat/06020602_santiago_alto_sto_domingo.csv"))
# autopista <- lee_autopista(fread("../dat/06020603_segovia_san_rafael.csv"))
autopista <- lee_autopista(fread("../dat/06020701_madrid_guadalajara.csv"))
# autopista <- lee_autopista(fread("../dat/06020702_madrid_arganda.csv"))
# autopista <- lee_autopista(fread("../dat/06020703_madrid_navalcarnero.csv"))
# autopista <- lee_autopista(fread("../dat/06020801_madrid_ocaña.csv"))
# autopista <- lee_autopista(fread("../dat/06020802_eje_aeropuerto.csv"))
# autopista <- lee_autopista(fread("../dat/06020803_ocaña_la_roda.csv"))
# autopista <- lee_autopista(fread("../dat/06020901_madrid_toledo.csv"))
# autopista <- lee_autopista(fread("../dat/06020902_cartagena_vera.csv"))
# autopista <- lee_autopista(fread("../dat/06020903_circunvalacion_alicante.csv"))
# autopista <- lee_autopista(fread("../dat/06021001_alto_de_las_pedrizas_malaga.csv"))
q1 <- autopista
# ts_mensual <- as_xts(q1, date_col = Mes_numeric)
ts_mensual <- ts(autopista$IMD_total, start=c(2003, 03), end=c(2017, 3), frequency=12)
plot(ts_mensual)
summary(ts_mensual)
fit <- stl(ts_mensual, s.window="period")
plot(fit)
monthplot(ts_mensual, col=1:12, pch=19)
seasonplot(ts_mensual, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
train <- window(ts_mensual, start=c(1990, 01), end=c(2014, 12))
plot(train)
test <- window(ts_mensual, start=c(2015, 01), end=c(2016, 12))
plot(test)
fit <- ets(train)
fit
prediccion <- forecast(fit)
par(mfrow=c(1,1))
plot(prediccion)
lines(test, col="red")
accuracy(prediccion,test)
fit2 <- auto.arima(train)
fit2
prediccion2 <- forecast(fit2)
prediccion2
plot(prediccion2)
lines(test, col="red")
accuracy(prediccion2,test)
accuracy(prediccion,test)
hist(residuals(fit2))
tsdisplay(residuals(fit2))
Box.test(residuals(fit2), type="Ljung")
l.ts_mensual <- log(ts_mensual)
par(mfrow=c(2,1))
plot(ts_mensual)
plot(l.ts_mensual)
summary(l.ts_mensual)
fit <- stl(l.ts_mensual, s.window="period")
plot(fit)
monthplot(l.ts_mensual, col=1:12, pch=19)
seasonplot(l.ts_mensual, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
train <- window(l.ts_mensual, start=c(1990, 01), end=c(2014, 12))
plot(train)
test <- window(l.ts_mensual, start=c(2015, 01), end=c(2016, 12))
plot(test)
fit <- ets(train)
fit
prediccion <- forecast(fit)
par(mfrow=c(1,1))
plot(prediccion)
lines(test, col="red")
accuracy(prediccion,test)
fit2 <- auto.arima(train)
fit2
prediccion2 <- forecast(fit2)
prediccion2
plot(prediccion2)
lines(test, col="red")
accuracy(prediccion2,test)
accuracy(prediccion,test)
tsdisplay(residuals(fit2))
hist(residuals(fit2))
Box.test(residuals(fit2),  type="Ljung")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
library(ggplot2)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
# autopista <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
# autopista <- lee_autopista(fread("../dat/06020101_montmelo_la_junquera.csv"))
# autopista <- lee_autopista(fread("../dat/06020102_barcelona_tarragona_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020103_montmelo_papiol_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020201_zaragoza_mediterraneo_A_2.csv"))
# autopista <- lee_autopista(fread("../dat/06020202_villalba_adanero_A_6.csv"))
# autopista <- lee_autopista(fread("../dat/06020301_tarragona_valencia_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020302_valencia_alicante_A_7.csv"))
# autopista <- lee_autopista(fread("../dat/06020303_ferrol_fr_portuguesa_A_9.csv"))
# autopista <- lee_autopista(fread("../dat/06020401_bilbao_zaragoza_A_68.csv"))
# autopista <- lee_autopista(fread("../dat/06020402_burgos_armiñon_A_1.csv"))
# autopista <- lee_autopista(fread("../dat/06020403_leon_campomanes_A_66.csv"))
# autopista <- lee_autopista(fread("../dat/06020501_malaga_guadiaro.csv"))
# autopista <- lee_autopista(fread("../dat/06020502_alicante_cartagena.csv"))
# autopista <- lee_autopista(fread("../dat/06020503_avila_villacastin.csv"))
# autopista <- lee_autopista(fread("../dat/06020601_leon_astorga.csv"))
# autopista <- lee_autopista(fread("../dat/06020602_santiago_alto_sto_domingo.csv"))
# autopista <- lee_autopista(fread("../dat/06020603_segovia_san_rafael.csv"))
autopista <- lee_autopista(fread("../dat/06020701_madrid_guadalajara.csv"))
# autopista <- lee_autopista(fread("../dat/06020702_madrid_arganda.csv"))
# autopista <- lee_autopista(fread("../dat/06020703_madrid_navalcarnero.csv"))
# autopista <- lee_autopista(fread("../dat/06020801_madrid_ocaña.csv"))
# autopista <- lee_autopista(fread("../dat/06020802_eje_aeropuerto.csv"))
# autopista <- lee_autopista(fread("../dat/06020803_ocaña_la_roda.csv"))
# autopista <- lee_autopista(fread("../dat/06020901_madrid_toledo.csv"))
# autopista <- lee_autopista(fread("../dat/06020902_cartagena_vera.csv"))
# autopista <- lee_autopista(fread("../dat/06020903_circunvalacion_alicante.csv"))
# autopista <- lee_autopista(fread("../dat/06021001_alto_de_las_pedrizas_malaga.csv"))
q1 <- autopista
# ts_mensual <- as_xts(q1, date_col = Mes_numeric)
ts_mensual <- ts(autopista$IMD_total, start=c(2003, 03), end=c(2017, 3), frequency=12)
plot(ts_mensual)
summary(ts_mensual)
fit <- stl(ts_mensual, s.window="period")
plot(fit)
monthplot(ts_mensual, col=1:12, pch=19)
seasonplot(ts_mensual, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
train <- window(ts_mensual, start=c(1990, 01), end=c(2014, 12))
plot(train)
test <- window(ts_mensual, start=c(2015, 01), end=c(2016, 12))
plot(test)
fit <- ets(train)
fit
prediccion <- forecast(fit)
par(mfrow=c(1,1))
plot(prediccion)
lines(test, col="red")
accuracy(prediccion,test)
fit2 <- auto.arima(train)
fit2
prediccion2 <- forecast(fit2)
prediccion2
plot(prediccion2)
lines(test, col="red")
accuracy(prediccion2,test)
accuracy(prediccion,test)
hist(residuals(fit2))
tsdisplay(residuals(fit2))
Box.test(residuals(fit2), type="Ljung")
l.ts_mensual <- log(ts_mensual)
par(mfrow=c(2,1))
plot(ts_mensual)
plot(l.ts_mensual)
summary(l.ts_mensual)
fit <- stl(l.ts_mensual, s.window="period")
plot(fit)
monthplot(l.ts_mensual, col=1:12, pch=19)
seasonplot(l.ts_mensual, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
train <- window(l.ts_mensual, start=c(1990, 01), end=c(2014, 12))
plot(train)
test <- window(l.ts_mensual, start=c(2015, 01), end=c(2016, 12))
plot(test)
fit <- ets(train)
fit
prediccion <- forecast(fit)
par(mfrow=c(1,1))
plot(prediccion)
lines(test, col="red")
accuracy(prediccion,test)
fit2 <- auto.arima(train)
fit2
prediccion2 <- forecast(fit2)
prediccion2
plot(prediccion2)
lines(test, col="red")
accuracy(prediccion2,test)
accuracy(prediccion,test)
tsdisplay(residuals(fit2))
hist(residuals(fit2))
Box.test(residuals(fit2),  type="Ljung")
View(autopista)
q1 <- autopista
# ts_mensual <- as_xts(q1, date_col = Mes_numeric)
ts_mensual <- ts(autopista$IMD_total, start=c(2003, 10), end=c(2017, 3), frequency=12)
plot(ts_mensual)
View(autopista)
