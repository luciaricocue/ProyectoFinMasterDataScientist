autopista_MENSUAL$Mes_numeric <- gsub(' ', "", autopista_MENSUAL$Mes_numeric)
autopista_MENSUAL$Mes_numeric <- paste(autopista_MENSUAL$Mes_numeric," ", autopista_MENSUAL$Year)
autopista_MENSUAL$Mes_numeric <- as.yearmon(parse_date(autopista_MENSUAL$Mes_numeric,
"%b %Y",locale=locale("es")))
return(autopista_MENSUAL)
}
sevilla_cadiz <- fread("dat/06020203_sevilla_cadiz.csv")
autopista <- sevilla_cadiz
table_sevilla_cadiz <- lee_autopista(autopista)
View(table_sevilla_cadiz)
#borro columnas sin información:
autopista$V7 <- autopista$V8 <- NULL
#borro filas al principio y final de la 1 a 6 y de la 362 a 368. Además la 34 que separa datos anuales de mensuales:
autopista <- autopista[!c(1:6, 34, 362:368) , ]
#separo la primera columna en Mes/Año y relleno las de año incompleto
autopista <- as.data.frame(autopista)
autopista <-  transform(autopista, V1 = colsplit(V1, split = " ", names = c('Year', 'Mes')))
#renombro columnas
autopista$Year <- autopista$V1$Year
autopista$Mes <- autopista$V1$Mes
autopista$V1 <- NULL
colnames(autopista) <- c("Longitud", "IMD_total", "variacion_IMD_tot.porcentaje", "IMD_pesados", "variacion_IMD_pes.porcentaje", "Year", "Mes")
#voy a poner los tipos de las columnas ok:
#tipo numérico
autopista$Longitud <- as.numeric(gsub(",", "\\.", autopista$Longitud))
autopista$IMD_total <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_total)))
autopista$variacion_IMD_tot.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_tot.porcentaje))
autopista$IMD_pesados <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_pesados)))
autopista$variacion_IMD_pes.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_pes.porcentaje))
#tipo character y relleno huecos:
autopista$Year <- gsub('[a-z]', NA, autopista$Year)
autopista <- autopista %>% mutate(Year = na.locf(Year, na.rm = FALSE,fromLast=FALSE))
autopista$Mes <- gsub('[0-9]', NA, autopista$Mes)
autopista_ANUAL <- autopista[1:27, 1:6]
autopista_MENSUAL <- autopista[28:354, ]
# Porque los 0s los pilla como NAs
autopista_ANUAL <- autopista_ANUAL %>%
mutate(variacion_IMD_pes.porcentaje = ifelse(is.na(variacion_IMD_pes.porcentaje),
100*(IMD_pesados-lead(IMD_pesados))/IMD_pesados, variacion_IMD_pes.porcentaje))
# Sólo debería de tener NAs en los datos de 1990 de variaciones, porque no tengo datos del 1989 con los que comparar.
# Ahora vamos a empezar a tratarlos como series temporales:
# autopista_ANUAL$Year <- years(autopista_ANUAL$Year)
# autopista_MENSUAL$Year <- years(autopista_MENSUAL$Year)
autopista_MENSUAL$yearmon <- paste(autopista_MENSUAL$Mes, " ", autopista_MENSUAL$Year)
autopista_MENSUAL$yearmon <- as.yearmon(paste(autopista_MENSUAL$Mes, " ",
autopista_MENSUAL$Year), "%b %Y")
# autopista_MENSUAL$Mes <- years(autopista_MENSUAL$Mes)
autopista_MENSUAL$Mes_numeric <- autopista_MENSUAL$Mes
autopista_MENSUAL$Mes_numeric <- paste(tolower(autopista_MENSUAL$Mes_numeric),".")
autopista_MENSUAL$Mes_numeric <- gsub('sep', "sept", autopista_MENSUAL$Mes_numeric)
autopista_MENSUAL$Mes_numeric <- gsub(' ', "", autopista_MENSUAL$Mes_numeric)
autopista_MENSUAL$Mes_numeric <- paste(autopista_MENSUAL$Mes_numeric," ", autopista_MENSUAL$Year)
autopista_MENSUAL$Mes_numeric <- as.yearmon(parse_date(autopista_MENSUAL$Mes_numeric,
"%b %Y",locale=locale("es")))
View(autopista_MENSUAL)
lee_autopista <- function(autopista){
#borro columnas sin información:
autopista$V7 <- autopista$V8 <- NULL
#borro filas al principio y final de la 1 a 6 y de la 362 a 368. Además la 34 que separa datos anuales de mensuales:
autopista <- autopista[!c(1:6, 34, 362:368) , ]
#separo la primera columna en Mes/Año y relleno las de año incompleto
autopista <- as.data.frame(autopista)
autopista <-  transform(autopista, V1 = colsplit(V1, split = " ", names = c('Year', 'Mes')))
#renombro columnas
autopista$Year <- autopista$V1$Year
autopista$Mes <- autopista$V1$Mes
autopista$V1 <- NULL
colnames(autopista) <- c("Longitud", "IMD_total", "variacion_IMD_tot.porcentaje", "IMD_pesados", "variacion_IMD_pes.porcentaje", "Year", "Mes")
#voy a poner los tipos de las columnas ok:
#tipo numérico
autopista$Longitud <- as.numeric(gsub(",", "\\.", autopista$Longitud))
autopista$IMD_total <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_total)))
autopista$variacion_IMD_tot.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_tot.porcentaje))
autopista$IMD_pesados <- as.numeric(gsub( "\\.", "",as.character(autopista$IMD_pesados)))
autopista$variacion_IMD_pes.porcentaje <- as.numeric(gsub( ",", "\\.",
autopista$variacion_IMD_pes.porcentaje))
#tipo character y relleno huecos:
autopista$Year <- gsub('[a-z]', NA, autopista$Year)
autopista <- autopista %>% mutate(Year = na.locf(Year, na.rm = FALSE,fromLast=FALSE))
autopista$Mes <- gsub('[0-9]', NA, autopista$Mes)
autopista_ANUAL <- autopista[1:27, 1:6]
autopista_MENSUAL <- autopista[28:354, ]
# Porque los 0s los pilla como NAs
autopista_ANUAL <- autopista_ANUAL %>%
mutate(variacion_IMD_pes.porcentaje = ifelse(is.na(variacion_IMD_pes.porcentaje),
100*(IMD_pesados-lead(IMD_pesados))/IMD_pesados, variacion_IMD_pes.porcentaje))
# Sólo debería de tener NAs en los datos de 1990 de variaciones, porque no tengo datos del 1989 con los que comparar.
# Ahora vamos a empezar a tratarlos como series temporales:
# autopista_ANUAL$Year <- years(autopista_ANUAL$Year)
# autopista_MENSUAL$Year <- years(autopista_MENSUAL$Year)
autopista_MENSUAL$yearmon <- paste(autopista_MENSUAL$Mes, " ", autopista_MENSUAL$Year)
autopista_MENSUAL$yearmon <- as.yearmon(paste(autopista_MENSUAL$Mes, " ",
autopista_MENSUAL$Year), "%b %Y")
# autopista_MENSUAL$Mes <- years(autopista_MENSUAL$Mes)
autopista_MENSUAL$Mes_numeric <- autopista_MENSUAL$Mes
autopista_MENSUAL$Mes_numeric <- paste(tolower(autopista_MENSUAL$Mes_numeric),".")
autopista_MENSUAL$Mes_numeric <- gsub('sep', "sept", autopista_MENSUAL$Mes_numeric)
autopista_MENSUAL$Mes_numeric <- gsub(' ', "", autopista_MENSUAL$Mes_numeric)
autopista_MENSUAL$Mes_numeric <- paste(autopista_MENSUAL$Mes_numeric," ", autopista_MENSUAL$Year)
autopista_MENSUAL$Mes_numeric <- as.yearmon(parse_date(autopista_MENSUAL$Mes_numeric,
"%b %Y",locale=locale("es")))
autopista_MENSUAL$yearmon <- NULL
return(autopista_MENSUAL)
}
sevilla_cadiz <- fread("dat/06020203_sevilla_cadiz.csv")
autopista <- sevilla_cadiz
table_sevilla_cadiz <- lee_autopista(autopista)
View(table_sevilla_cadiz)
source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
View(table_sevilla_cadiz)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
# setwd("~/Descargas/PROYECTO_FIN_DE_MASTER")
montmelo_la_junquera <- fread("dat/06020101_montmelo_la_junquera.csv")
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
# setwd("~/Descargas/PROYECTO_FIN_DE_MASTER")
montmelo_la_junquera <- fread("dat/06020101_montmelo_la_junquera.csv")
sevilla_cadiz <- fread("dat/06020203_sevilla_cadiz.csv")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
source(src/funciones.R)
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
source("src/funciones.R"")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
source("src/funciones.R")
source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
source("src/funciones.R")
# source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
View(table_sevilla_cadiz)
View(table_sevilla_cadiz)
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
montmelo_la_junquera <- fread("dat/06020101_montmelo_la_junquera.csv")
sevilla_cadiz <- fread("dat/06020203_sevilla_cadiz.csv")
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
source("src/funciones.R")
# source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
montmelo_la_junquera <- fread("dat/06020101_montmelo_la_junquera.csv")
sevilla_cadiz <- fread("dat/06020203_sevilla_cadiz.csv")
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
source("src/funciones.R")
# source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
source("src/funciones.R")
# source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
# autopista <- sevilla_cadiz
sevilla_cadiz <- lee_autopista(fread("dat/06020203_sevilla_cadiz.csv"))
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
source("src/funciones.R")
# source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
montmelo_la_junquera <- fread("dat/06020101_montmelo_la_junquera.csv")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("src/funciones.R")
# source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
montmelo_la_junquera <- fread("dat/06020101_montmelo_la_junquera.csv")
# sevilla_cadiz <- fread("dat/06020203_sevilla_cadiz.csv")
autopista <- fread("dat/06020203_sevilla_cadiz.csv")
setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
autopista <- fread("dat/06020203_sevilla_cadiz.csv")
autopista <- fread("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/dat/06020203_sevilla_cadiz.csv")
sevilla_cadiz <- lee_autopista(autopista)
autopista <- fread("../dat/06020203_sevilla_cadiz.csv")
sevilla_cadiz <- lee_autopista(autopista)
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
# source('C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist/src/funciones.R')
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
montmelo_la_junquera <- fread("dat/06020101_montmelo_la_junquera.csv")
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
montmelo_la_junquera <- fread("../dat/06020101_montmelo_la_junquera.csv")
# sevilla_cadiz <- fread("../dat/06020203_sevilla_cadiz.csv")
autopista <- fread("../dat/06020203_sevilla_cadiz.csv")
sevilla_cadiz <- lee_autopista(autopista)
# autopista <- fread("../dat/06020203_sevilla_cadiz.csv")
sevilla_cadiz <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
View(sevilla_cadiz)
# autopista <- fread("../dat/06020203_sevilla_cadiz.csv")
sevilla_cadiz <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
montmelo_la_junquera <- lee_autopista(fread("../dat/06020101_montmelo_la_junquera.csv"))
q1 <- sevilla_cadiz
serie_mensual <- as_xts(q1, date_col = yearmon)
View(sevilla_cadiz)
q1 <- sevilla_cadiz
serie_mensual <- as_xts(q1, date_col = Mes_numeric)
plot(serie_mensual)
# subset the time series (June 2014 to December 2014)
serie_anual2_partial <- window(serie_anual2, start=c(2000), end=c(2014))
# plot series
plot(serie_anual2_partial)
# subset the time series (June 2014 to December 2014)
serie_anual2_partial <- window(serie_mensual, start=c(2000), end=c(2014))
# plot series
plot(serie_anual2_partial)
# subset the time series (June 2014 to December 2014)
train <- window(serie_mensual, start=c(2000), end=c(2014))
# plot series
plot(train)
# subset the time series (June 2014 to December 2014)
train <- window(serie_mensual, start=c(1990), end=c(2014))
# plot series
plot(train)
# subset the time series (June 2014 to December 2014)
test <- window(serie_mensual, start=c(2015), end=c(2017))
# plot series
plot(test)
monthdays <- rep(c(31,28,31,30,31,30,31,31,30,31,30,31),14)
monthdays[26 + (4*12)*(0:2)] <- 29
rep(c(31,28,31,30,31,30,31,31,30,31,30,31),14)
monthdays
monthdays <- rep(c(31,28,31,30,31,30,31,31,30,31,30,31),27)#desde 1990 a 2017 hay 27 años
monthdays[26 + (4*12)*(0:2)] <- 29 #el rpimer bisiesto es 1992 (12+12+2=26)
par(mfrow=c(2,1))
plot(serie_mensual, main="Mensual IMD per autopista",
ylab="Pounds",xlab="Years")
plot(serie_mensual/monthdays, main="Media IMD per autopista por día",
ylab="Pounds", xlab="Years")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
# setwd("C:/Users/LucÃÂ�a/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
# montmelo_la_junquera <- fread("../dat/06020101_montmelo_la_junquera.csv")
# sevilla_cadiz <- fread("../dat/06020203_sevilla_cadiz.csv")
?causalImpact
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
sevilla_cadiz <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
# montmelo_la_junquera <- lee_autopista(fread("../dat/06020101_montmelo_la_junquera.csv"))
q1 <- sevilla_cadiz
serie_mensual <- as_xts(q1, date_col = Mes_numeric)
plot(serie_mensual)
q1 <- sevilla_cadiz
ts_mensual <- as_xts(q1, date_col = Mes_numeric)
plot(ts_mensual)
# subset the time series (June 2014 to December 2014)
test <- window(ts_mensual, start=c(2015), end=c(2017))
# plot series
plot(test)
autopista_MENSUAL <- autopista_MENSUAL %>% arrange(yearmon)
ts_mensual <- ts(autopista_MENSUAL$IMD_total, start=c(1990, 1), end=c(2017, 3), frequency=12)
plot(ts_mensual)
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
# montmelo_la_junquera <- fread("../dat/06020101_montmelo_la_junquera.csv")
# sevilla_cadiz <- fread("../dat/06020203_sevilla_cadiz.csv")
sevilla_cadiz <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
# montmelo_la_junquera <- lee_autopista(fread("../dat/06020101_montmelo_la_junquera.csv"))
q1 <- sevilla_cadiz
ts_mensual <- as_xts(q1, date_col = Mes_numeric)
plot(ts_mensual)
# subset the time series (June 2014 to December 2014)
train <- window(ts_mensual, start=c(1990), end=c(2014))
# plot series
plot(train)
# subset the time series (June 2014 to December 2014)
test <- window(ts_mensual, start=c(2015), end=c(2017))
# plot series
plot(test)
# autopista_MENSUAL <- autopista_MENSUAL %>% arrange(yearmon)
# ts_mensual <- ts(autopista_MENSUAL$IMD_total, start=c(1990, 1), end=c(2017, 3), frequency=12)
plot(ts_mensual)
# Seasonal decomposition
fit <- stl(ts_mensual, s.window="period")
plot(fit)
# additional plots
monthplot(ts_mensual)
# additional plots
seasonplot(ts_mensual, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
View(ts_mensual)
# Seasonal decomposition
fit <- stl(ts_mensual, s.window="period")
plot(fit)
# additional plots
monthplot(ts_mensual)
# additional plots
ts_mensual <- ts(autopista_MENSUAL$IMD_total, start=c(1990, 1), end=c(2017, 3), frequency=12)
seasonplot(ts_mensual, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
library(data.table)
library(reshape)
library(zoo)
library(lubridate)
library(readr)
library(stats)
library(xts)
library(tidyquant)
library(forecast)
# setwd("C:/Users/Lucía/Desktop/ProyectoFinMasterDataScientist")
source("../src/funciones.R")
# montmelo_la_junquera <- fread("../dat/06020101_montmelo_la_junquera.csv")
# sevilla_cadiz <- fread("../dat/06020203_sevilla_cadiz.csv")
sevilla_cadiz <- lee_autopista(fread("../dat/06020203_sevilla_cadiz.csv"))
# montmelo_la_junquera <- lee_autopista(fread("../dat/06020101_montmelo_la_junquera.csv"))
q1 <- sevilla_cadiz
ts_mensual <- as_xts(q1, date_col = Mes_numeric)
plot(ts_mensual)
# subset the time series (June 2014 to December 2014)
train <- window(ts_mensual, start=c(1990), end=c(2014))
# plot series
plot(train)
# subset the time series (June 2014 to December 2014)
test <- window(ts_mensual, start=c(2015), end=c(2017))
# plot series
plot(test)
# autopista_MENSUAL <- autopista_MENSUAL %>% arrange(yearmon)
# ts_mensual <- ts(autopista_MENSUAL$IMD_total, start=c(1990, 1), end=c(2017, 3), frequency=12)
plot(ts_mensual)
# Seasonal decomposition
fit <- stl(ts_mensual, s.window="period")
plot(fit)
# additional plots
monthplot(ts_mensual)
# additional plots
ts_mensual2 <- ts(autopista_MENSUAL$IMD_total, start=c(1990, 1), end=c(2017, 3), frequency=12)#si no da error por inicio y fin
seasonplot(ts_mensual2, year.labels=TRUE, year.labels.left=TRUE, col=1:27, pch=19)
# additional plots
monthplot(ts_mensual, col=1:12, pch=19)
# additional plots
monthplot(ts_mensual, col=1:12, pch=19, year.labels=TRUE, year.labels.left=TRUE)
# additional plots
monthplot(ts_mensual, col=1:12, pch=19)
summary(ts_mensual)
ts
ts_mensual
# triple exponential - models level, trend, and seasonal components
fit <- HoltWinters(test)
print(fit)
plot(fit)
# triple exponential - models level, trend, and seasonal components
fit <- HoltWinters(ts_mensual)
print(fit)
plot(fit)
# triple exponential - models level, trend, and seasonal components
fit <- HoltWinters(train)
print(fit)
plot(fit)
# predictive accuracy
library(forecast)
accuracy(fit)
# predict next three future values
library(forecast)
forecast(fit, 3)
plot(forecast(fit, 3))
# predict next three future values
library(forecast)
forecast(fit, 3)
plot(forecast(fit, 3))
plot(test)
# predict next three future values
library(forecast)
forecast(fit, 3)
plot(forecast(fit, 12))
plot(test)
# predict next three future values
library(forecast)
forecast(fit, 3)
plot(forecast(fit, 12))
plot(ts_mensual)
# fit an ARIMA model of order P, D, Q
fit <- arima(myts, order=c(p, d, q))
fit <- stl(ts_mensual, s.window=5)
plot(ts_mensual, col="grey",
main="Con ajuste estacional")
fit <- stl(ts_mensual, s.window=5)
plot(ts_mensual)
lines(seasadj(fit),col="red",ylab="Seasonally adjusted")
fit <- stl(ts_mensual, s.window=5)
plot(ts_mensual)
lines(seasadj(fit),col="red",ylab="Seasonally adjusted")
fit <- stl(ts_mensual, s.window=5)
# plot(ts_mensual)
lines(seasadj(fit),col="red",ylab="Seasonally adjusted")
fit <- stl(ts_mensual, s.window=5)
# plot(ts_mensual)
lines(seasadj(fit),col="red")
fit <- stl(ts_mensual)
fit <- stl(ts_mensual, s.window="period")
# plot(ts_mensual)
lines(seasadj(fit),col="red")
fit <- stl(ts_mensual, s.window="period")
plot(ts_mensual)
lines(seasadj(fit),col="red")
fit <- stl(ts_mensual, s.window="period")
plot(ts_mensual)
lines(seasadj(fit),col="red")
fit <- stl(ts_mensual, s.window="period")
plot(ts_mensual)
lines(seasadj(ts_mensual),col="red")
